<!DOCTYPE html>
<html lang="en" ng-app="index" >

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Checkers</title>
    <!-- Core CSS -->
    <link href="../css/core.css" rel="stylesheet">

    <!-- Pure -->
    <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.6.0/pure-min.css">



    <!-- Angularjs -->
     <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.8/angular.min.js"></script>
     <script src="../js/index.js"></script>



</head>

<body ng-controller="indexController">
    <div class="checker-layout">
        <div class="header"></div>
        <div class="checker" ng-repeat="checker in checkers track by $index">
            <div class="checker-content">
                <div class="checker-head">
                    <div class="pure-g">
                        <div class="pure-u-5-6">
                            <div ng-click="checkerFunc.modify($index)", ng-hide="checkerFunc.name_input_display[$index]">{{checker.name}}</div>
                            <input class="checker-name" type="text" ng-model="checker.name", ng-blur="checkerFunc.update(checker, $index)", ng-hide="!checkerFunc.name_input_display[$index]">
                        </div>
                        <div class="pure-u-1-6">
                            <a class="delete-button", ng-click="checkerFunc.delete(checker, $index)">x</a>
                        </div>
                    </div>
                </div>
                <div class="task-list">
                    <div class="task" ng-repeat="task in checker.tasks track by $index">
                        <div class="pure-g">
                            <div class="pure-u-5-6">
                                <div class="pure-g">
                                    <div class="pure-u-1-6">
                                        <input type="checkbox", ng-model="task.finished", ng-click="taskFunc.updateFinished(checker, task)">
                                        <img class="task-alarm-button", src="../img/core/alarm.png" ng-click="taskFunc.switchDateSet(task._id)", ng-hide="taskFunc.duedate_input_display[task._id]"/>
                                    </div>
                                    <div class="pure-u-5-6">
                                        <div ng-click="taskFunc.modify(task._id)", ng-hide="taskFunc.name_input_display[task._id]">{{task.name}}</div>
                                        <textarea ng-model="task.name", ng-blur="taskFunc.update(task)", ng-hide="!taskFunc.name_input_display[task._id]" ></textarea>
                                        <span class="due-date" ng-hide="taskFunc.duedate_input_display[task._id]">{{task.due_date.toLocaleDateString()}}</span>
                                    </div>
                                </div>
                            </div>
                            <div class="pure-u-1-6">
                                <a class="task-delete-button", ng-click="taskFunc.delete(checker, task, $index)">x</a>
                            </div>
                        </div>
                        <div class="date-set-block" ng-hide="!taskFunc.duedate_input_display[task._id]">
                            <input type="date" ng-model="task.due_date" ng-change="taskFunc.setDueDate(task)">
                            <a class="task-delete-button", ng-click="taskFunc.switchDateSet(task._id)">x</a>
                        </div>
                    </div>
                    <div class="task" ng-hide="!taskFunc.content_input_display[$index]">
                        <textarea type="text" ng-model="taskFunc.content_input[$index]"></textarea>
                        <a class="save-button" ng-click="taskFunc.save(checker, $index)">儲存</a>
                    </div>
                </div>
                <a ng-click="taskFunc.add($index)", ng-hide="taskFunc.content_input_display[$index]">
                    <div class="add-task-button">新增任務</div>
                </a>
            </div>
            <div class="checker-arrow" ng-class="{blink: checker.unfinished && blink_animation}", ng-if="$index!==checkers.length-1"></div>
        </div>
        <div class="checker" ng-hide="!checkerFunc.content_input_display">
            <div class="checker-content">
                <input type="text" ng-model="checkerFunc.content_input">
                <a class="save-button" ng-click="checkerFunc.save()">儲存</a>
            </div>
        </div>
        <a ng-click="checkerFunc.add()" ng-hide="checkerFunc.content_input_display">
            <div class="add-checker-button">新增專案</div>
        </a>

    </div>
</body>

</html>
